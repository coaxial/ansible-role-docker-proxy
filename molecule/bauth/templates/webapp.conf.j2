server {
  listen 80;

  location /nope/ {
    auth_basic "Restricted";
    auth_basic_user_file /etc/nginx/.htpasswd;
    return 200 "I am the one who knocks";
  }

  location / {
    auth_basic "Restricted";
    auth_basic_user_file /etc/nginx/.htpasswd;
    proxy_pass http://{{ _dp__docker_gw_ip.stdout }}:{{ upstream.port }};
  }
}
